# 📋 FUNCTION - 프로젝트 기능 명세서

**Household Ledger - 스마트한 그룹 기반 가계부 시스템**

---

## 📖 개요

Household Ledger는 개인과 그룹이 함께 사용할 수 있는 현대적인 가계부 웹 애플리케이션입니다. 세련된 슬레이트 디자인과 혁신적인 통합 인증 시스템, 강력한 다중 사용자 시스템을 통해 가계 관리를 혁신합니다.

---

## 🎨 **1. 디자인 시스템 (Design System) - 2025.01.08 5개 핵심 페이지 완성**

### 📱 현대적 UI/UX

- **슬레이트 색상 팔레트**: 세련된 모노톤 디자인 (그라데이션 제거)
- **한국어 웹폰트**: `EunpyeongSagaDogseo` 폰트로 브랜드 아이덴티티 강화
- **애니메이션**: 270라인 CSS (fade-in, slide-up, bounce, pulse, spin)
- **통일된 색상 체계**: 모든 UI 컴포넌트 일관된 스타일 (Button, Badge, Input, Select)
- **접근성 향상**: WCAG AA 준수 색상 대비
- **마이크로인터랙션**: 호버 스케일, 부드러운 트랜지션

### 📐 반응형 디자인

- **모바일 우선**: 375px부터 데스크톱까지 완벽 대응
- **적응형 레이아웃**: 테이블(데스크톱) / 카드(모바일) 자동 전환
- **터치 친화적**: 큰 버튼, 적절한 터치 영역

**구현 상태**: ✅ **완료** (2025년 5개 핵심 페이지 완성, TailwindCSS v3.4 안정화)

### 🆕 **완성된 5개 핵심 페이지 (2025.01.08)**

- **📊 월요약 대시보드** (`/`): 수입/지출 요약, 카테고리 분석, 예산 현황
- **💳 거래내역** (`/transactions`): 필터링, 검색, 정렬 시스템
- **📈 월별 통계** (`/statistics`): 차트, 트렌드 분석, 분할 현황
- **👤 내 정보** (`/profile`): 프로필, 그룹 관리, 알림 설정
- **🏷️ 카테고리** (`/categories`): CRUD 시스템, 색상 관리

### 🎨 **간소화된 네비게이션**

- **데스크탑**: 좌측 사이드바 (메인/설정 2개 섹션)
- **모바일**: 하단 네비게이션 (5개 메뉴 균등 배치)
- **빠른 입력**: 플로팅 우하단 버튼 배치

---

## 🔐 **2. 통합 인증 시스템 (Unified Authentication) - 2024.12.22 혁신적 개선**

### 🛡️ 보안 인증

- **비밀번호 암호화**: BCrypt 솔트 12라운드
- **JWT 토큰**: Access + Refresh 토큰 dual 시스템
- **쿠키 저장**: HTTP-only 쿠키로 XSS 방지
- **토큰 갱신**: 자동 refresh로 seamless UX

### 🚀 혁신적 이메일 우선 플로우

- **이메일 우선 설계**: 이메일 입력 → 자동 기존/신규 회원 분기
- **분할 이메일 입력**: username + domain select 방식
- **7개 주요 도메인**: naver.com(우선), gmail.com, daum.net, kakao.com 등
- **커스텀 도메인**: "기타" 선택시 직접 입력 지원
- **API 연동**: `/api/auth/check-email` 엔드포인트로 실시간 검증

### 📝 단계별 사용자 경험

- **1단계**: 이메일 입력 (username@domain 방식)
- **2단계**: 기존 회원 → 비밀번호 입력 / 신규 회원 → 회원가입 페이지
- **단계별 검증**: React Hook Form + Zod 스키마 (emailStageSchema/passwordStageSchema)
- **URL 파라미터**: 이메일 정보 자동 전달
- **사용자 친화적**: 네이버 도메인 우선, 직관적 선택

### 🔄 세션 관리

- **자동 로그아웃**: 토큰 만료시 자동 처리
- **다중 디바이스**: 여러 기기에서 동시 로그인 지원
- **보안 로그**: 로그인 시도, IP 추적 (감사 로그)

**구현 상태**: ✅ **완료** (혁신적 UX + API + 보안 시스템)

---

## 👥 **3. 그룹 관리 시스템 (Group Management)**

### 🏠 그룹 생성 & 관리

- **그룹 생성**: 간단한 이름으로 그룹 생성
- **소유권 관리**: OWNER → ADMIN → MEMBER 3단계 권한
- **그룹 설정**: 이름 변경, 멤버 관리, 그룹 삭제

### 📧 초대 시스템

- **초대 코드 발급**: "FAMILY2024ABC" 형식 (7일 유효)
- **코드 공유**: 카카오톡, 이메일 등으로 간편 공유
- **자동 참여**: 코드 입력만으로 즉시 그룹 참여
- **만료 관리**: 자동 만료, 재발급 기능

### 👤 멤버 관리

- **역할 기반**: Owner는 모든 권한, Admin은 관리 권한, Member는 기본 권한
- **멤버 목록**: 참여 날짜, 역할, 활동 상태 표시
- **권한 위임**: Owner가 Admin 권한 부여/회수
- **멤버 제외**: 부적절한 멤버 강제 퇴출

### 🔄 그룹 전환

- **다중 그룹**: 한 사용자가 여러 그룹 참여 가능
- **빠른 전환**: 헤더에서 그룹 전환 드롭다운
- **컨텍스트 유지**: 그룹별 데이터 격리

**구현 상태**: ✅ **완료** (UI + API + 권한 시스템)

---

## 💳 **4. 계좌 관리 시스템 (Account Management)**

### 🏦 계좌 타입

- **현금 (CASH)**: 지갑, 용돈, 비상금 등
- **카드 (CARD)**: 신용카드, 체크카드, 포인트카드 등
- **은행 (BANK)**: 적금, 예금, 투자 계좌 등
- **기타 (OTHER)**: 전자지갑, 상품권, 대출 등

### 👤 소유권 관리

- **개인 계좌**: USER 타입, 개인만 사용
- **그룹 계좌**: GROUP 타입, 그룹 멤버 공동 사용
- **권한 제어**: 계좌 생성자와 그룹 ADMIN만 수정/삭제

### 💰 잔액 관리

- **실시간 계산**: 거래 발생시 자동 잔액 업데이트
- **통화 지원**: KRW 기본, 다른 통화 확장 가능
- **마이너스 잔액**: 신용카드, 대출 등 음수 잔액 지원

### 🔍 고급 기능

- **검색 & 필터**: 이름, 타입, 잔액 범위로 검색
- **활성/비활성**: 사용하지 않는 계좌 비활성화
- **정렬**: 잔액순, 이름순, 생성일순 정렬

**구현 상태**: ✅ **완료** (CRUD + UI + API + 권한 시스템)

---

## 📁 **5. 카테고리 시스템 (Category System)**

### 🎯 기본 카테고리 (15개)

**지출 카테고리 (10개)**:

- 🍔 식비, 🚗 교통비, 🏠 주거비, 👕 의류/미용, 🏥 의료/건강
- 📚 교육/문화, 🎮 여가/오락, 🛒 생필품, 📱 통신비, 💼 기타 지출

**수입 카테고리 (3개)**:

- 💰 월급, 🎁 용돈/선물, 💼 기타 수입

**이체 카테고리 (2개)**:

- 💸 계좌 이체, 💳 카드 결제

### 🎨 커스텀 카테고리

- **색상 선택**: 16가지 색상 팔레트
- **이모지 지원**: 직관적인 시각적 구분
- **타입별 분류**: 수입/지출/이체 타입별 관리
- **중복 방지**: 같은 이름의 카테고리 생성 차단

### 🔒 권한 관리

- **개인 카테고리**: 개인만 사용
- **그룹 카테고리**: 그룹 멤버 공동 사용
- **기본 카테고리**: 수정 불가, 삭제 불가

**구현 상태**: ✅ **완료** (기본 15개 + 커스텀 + UI + API)

---

## 💰 **6. MVP 가계부 시스템 (Ledger MVP)**

### ⚡ 빠른 거래 입력 (QuickAddBar)

- **한 줄 입력**: 날짜/타입/금액/카테고리/계좌/메모 통합 입력
- **스마트 입력**:
  - 날짜: 기본 오늘, 캘린더 피커
  - 금액: 천단위 콤마, 모바일 숫자 키패드
  - 카테고리/계좌: 검색 가능한 콤보박스
  - 메모: 자동완성, 최근 사용 제안
- **키보드 단축키**:
  - Enter: 저장
  - Shift+Enter: 저장 후 계속
  - Esc: 초기화
- **자동 분류**: 메모 기반 카테고리 제안

### 📋 거래 내역 리스트 (InboxList)

- **최신순 정렬**: 가장 최근 거래가 맨 위
- **반응형 테이블**: 데스크톱 테이블 / 모바일 카드
- **실시간 업데이트**: 새 거래 즉시 반영
- **인라인 편집**: 클릭으로 바로 수정
- **키보드 네비게이션**: ↑↓ 키로 행 이동, E키로 편집, Del키로 삭제
- **Undo 시스템**: 5초간 되돌리기 가능

### 🎯 프리셋 시스템 (PresetPanel)

- **자주 쓰는 거래**: "☕ 커피 5,000원 (식비/현금)" 형태로 저장
- **원클릭 입력**: 프리셋 클릭으로 QuickAdd에 자동 입력
- **키보드 단축키**: 숫자키 1-9로 즉시 적용
- **스마트 제안**: 사용 빈도 기반 자동 프리셋 생성
- **금액 수정**: 프리셋 적용 후 금액만 수정 가능

### 📝 벌크 입력 (BulkInput)

- **텍스트 붙여넴기**:
  - "8/24 점심 12000 식비 국민카드"
  - "2024-08-23 커피 4800 식비 현금 #야근"
- **자동 파싱**: 날짜, 금액, 메모, 카테고리, 계좌 자동 인식
- **미리보기 모달**: 파싱 결과 확인 후 일괄 저장
- **오류 처리**: 파싱 실패한 행은 빨간색 표시, 수동 수정
- **매핑 시스템**: 카테고리/계좌 이름 → ID 자동 매핑

### 🧠 Zustand 스토어

- **로컬 상태 관리**: 빠른 반응성, 오프라인 지원
- **localStorage 퍼시스트**: 새로고침 후에도 데이터 유지
- **Context 브릿지**: 기존 React Context와 연동
- **타입 안전성**: 완전한 TypeScript 타입 정의

**구현 상태**: ✅ **완료** (4개 컴포넌트 + Zustand 스토어 + 타입 시스템)
**API 연동 상태**: ✅ **100% 완료** (UI + API 완전 연결) 🎉

---

## 🧾 **7. 거래 관리 시스템 (Transaction Management)**

### 💸 거래 타입

- **지출 (EXPENSE)**: 일반적인 소비 거래
- **수입 (INCOME)**: 월급, 용돈, 기타 수입
- **이체 (TRANSFER)**: 계좌 간 자금 이동

### 👥 참여자 시스템

- **거래 소유자**: 실제 거래를 입력한 사용자
- **참여자**: 거래 비용을 나누는 사용자들
- **분할 방식**:
  - 비율 분할: 3:2:1 비율로 나누기
  - 금액 분할: 15000, 10000, 5000원으로 나누기
  - 균등 분할: 참여자 수만큼 균등하게

### 🏷️ 태그 시스템

- **다중 태그**: 하나의 거래에 여러 태그 적용
- **자동 태그**: "#야근", "#데이트", "#회식" 등 자동 제안
- **태그 분석**: 태그별 지출 통계

### 📎 첨부파일

- **영수증 첨부**: 사진, PDF 업로드
- **파일 크기 제한**: 최대 10MB
- **썸네일 생성**: 이미지 자동 썸네일

### 🔍 고급 검색

- **날짜 범위**: 특정 기간 거래 조회
- **금액 범위**: 최소/최대 금액 필터
- **키워드 검색**: 메모, 가맹점명 검색
- **다중 필터**: 계좌, 카테고리, 태그 조합 검색

**구현 상태**: ✅ **스키마 완료** / 🔄 **API 연동 대기** (UI는 MVP에서 구현됨)

---

## 💹 **8. 정산 시스템 (Settlement System)**

### 📊 자동 정산

- **기간별 정산**: 주간, 월간, 사용자 지정 기간
- **참여자 기반**: 거래 참여자들 자동 계산
- **정산 방식**:
  - 단순 정산: A가 B에게 10,000원 송금
  - 최적 정산: 최소 송금 횟수로 정산 완료

### 💰 정산 내역

- **정산 아이템**: 각 사용자별 받을 금액/보낼 금액
- **상태 관리**: 정산 대기 → 정산 완료
- **알림 시스템**: 정산 요청, 완료 알림

### 📈 정산 리포트

- **그래프**: 누가 얼마나 썼는지 시각화
- **비율**: 전체 지출 대비 개인 지출 비율
- **트렌드**: 월별 정산 패턴 분석

**구현 상태**: ✅ **스키마 완료** / ⏳ **UI 개발 대기**

---

## 📊 **9. 예산 관리 시스템 (Budget Management)**

### 💳 예산 설정

- **월별 예산**: 매월 총 예산 금액 설정
- **카테고리별 예산**: 식비, 교통비 등 세부 예산
- **자동 이월**: 남은 예산 다음 달 이월

### 📈 진행률 추적

- **실시간 업데이트**: 거래 발생시 예산 차감
- **시각적 표시**: 프로그레스 바, 색상 코딩
- **경고 시스템**: 80%, 100% 도달시 알림

### 🎯 예산 분석

- **월별 비교**: 이번 달 vs 지난 달
- **카테고리 분석**: 어느 카테고리에서 초과했는지
- **예산 추천**: AI 기반 다음 달 예산 제안

**구현 상태**: ✅ **스키마 완료** / ⏳ **UI 개발 대기**

---

## 🔄 **10. 정기 거래 시스템 (Recurring Transactions)**

### ⏰ 반복 규칙

- **월별 반복**: 매월 25일 월급, 매월 1일 월세
- **주별 반복**: 매주 월요일 용돈
- **사용자 지정**: 2주마다, 3개월마다 등

### 🤖 자동 생성

- **스케줄링**: 지정된 날짜에 자동 거래 생성
- **알림**: 거래 생성 전 미리 알림
- **수동 확인**: 생성 전 사용자 승인 옵션

### ⚙️ 규칙 관리

- **활성/비활성**: 일시적으로 정기 거래 중단
- **종료일**: 특정 날짜까지만 반복
- **수정**: 금액, 계좌, 카테고리 변경

**구현 상태**: ✅ **스키마 완료** / ⏳ **UI 개발 대기**

---

## 🔒 **11. 감사 로그 시스템 (Audit Log)**

### 📝 활동 추적

- **모든 변경**: 거래 생성/수정/삭제 기록
- **사용자 식별**: 누가 언제 무엇을 했는지
- **변경 내역**: 변경 전/후 데이터 저장

### 🔍 로그 조회

- **사용자별**: 특정 사용자 활동 조회
- **기간별**: 특정 기간 활동 조회
- **엔티티별**: 거래, 계좌, 그룹별 변경 내역

### 🛡️ 보안 감사

- **로그인 기록**: 성공/실패 로그인 시도
- **권한 변경**: 그룹 권한 변경 기록
- **민감한 작업**: 계좌 삭제, 그룹 탈퇴 등

**구현 상태**: ✅ **스키마 완료** / ⏳ **UI 개발 대기**

---

## 🚀 **12. 시스템 안정성 & 성능**

### 🔧 기술 스택

- **Frontend**: Next.js 15, TypeScript, Tailwind CSS v4
- **Backend**: Next.js API Routes, Prisma, MySQL 8.4
- **State**: React Context + Zustand (하이브리드)
- **인증**: JWT + BCrypt + HTTP-only Cookie
- **배포**: Docker 컨테이너 지원

### ⚡ 성능 최적화

- **코드 분할**: 페이지별 lazy loading
- **이미지 최적화**: Next.js Image 컴포넌트
- **캐싱**: API 응답 캐싱, localStorage 활용
- **압축**: Gzip 압축, 번들 사이즈 최적화

### 🛡️ 보안

- **HTTPS**: 모든 통신 암호화
- **CSRF 방지**: CSRF 토큰 적용
- **XSS 방지**: 입력값 sanitization
- **SQL Injection 방지**: Prisma ORM 사용

### 📱 PWA 지원 (계획)

- **오프라인 지원**: Service Worker 캐싱
- **설치 가능**: 홈 화면에 앱 추가
- **푸시 알림**: 정산 알림, 예산 경고

**구현 상태**: ✅ **완료** (기본 시스템) / 🔄 **PWA 개발 예정**

---

## 📊 **현재 구현 상태 요약**

### ✅ **100% 완료**

- 🎨 **현대적 디자인 시스템** (슬레이트 색상 + 한국어 폰트)
- 🔐 **통합 인증 시스템** (이메일 우선 + 분할 입력)
- 👥 **그룹 관리 시스템** (생성/초대/권한)
- 💳 **계좌 관리 시스템** (CRUD/검색/필터)
- 📁 **카테고리 시스템** (15개 기본 + 커스텀)
- 💰 **MVP 가계부 UI** (4개 컴포넌트 + Zustand)
- 🚀 **사용자 여정 단순화** (메인 페이지 리디렉션)

### ✅ **100% 완료** 🎉

- 🧾 거래 관리 시스템 (UI + API 완전 연동)

### ⏳ **스키마 완료, UI 개발 대기**

- 💹 정산 시스템
- 📊 예산 관리 시스템
- 🔄 정기 거래 시스템
- 🔒 감사 로그 시스템

### 🔄 **개발 예정**

- 📱 PWA 지원
- 📈 고급 분석 & 리포트
- 🌐 다국어 지원
- 🎨 테마 시스템

---

## 🎯 **다음 개발 우선순위 (2024.12.22 업데이트)**

1. **분할 및 정산 시스템** (Phase 7) - 그룹 가계부 핵심 차별화 기능
2. **예산 관리 UI 개발** - 재정 계획 기능
3. **고급 분석 대시보드** - 데이터 시각화
4. **모바일 PWA** - 네이티브 앱 경험
5. **다국어 지원** - 글로벌 확장 준비

---

## 💡 **혁신적인 특징**

### 🚀 **차별화 포인트 (2024.12.22 혁신 완료)**

- **현대적 슬레이트 디자인**: 2024년 최신 트렌드 모노톤 색상
- **혁신적 통합 인증**: 이메일 우선 + 분할 입력 방식
- **한국어 브랜드 폰트**: `EunpyeongSagaDogseo` 웹폰트로 아이덴티티 강화
- **하이브리드 상태관리**: Context + Zustand 최적 조합
- **그룹 중심 설계**: 다중 사용자 협업 최적화
- **빠른 입력 UX**: 수동 입력을 가장 빠르게 만드는 시스템
- **완전한 타입 안전성**: TypeScript 100% 활용
- **심플한 사용자 여정**: 불필요한 중간 단계 완전 제거

### 🎭 **사용자 경험**

- **원클릭 거래 입력**: 3초 안에 거래 등록
- **실시간 동기화**: 그룹 멤버 간 즉시 공유
- **오프라인 지원**: 인터넷 없어도 사용 가능
- **키보드 친화적**: 마우스 없이도 모든 기능 사용

---

## 🎉 **결론**

Household Ledger는 **개인과 그룹을 위한 차세대 가계부 시스템**입니다.

- ✅ **현재 100% 완성**된 MVP + 현대적 UX로 즉시 사용 가능
- 🎨 **2024년 최신 슬레이트 디자인** + 한국어 폰트로 사용자 경험 극대화
- 🚀 **혁신적 통합 인증 시스템**으로 간편하고 직관적인 로그인/회원가입
- 👥 **강력한 그룹 시스템**으로 가족, 친구, 동료와 함께 관리
- ⚡ **빠른 입력과 실시간 동기화**로 일상 속 자연스러운 사용
- 🎯 **심플한 사용자 여정**으로 로그인 후 바로 가계부/그룹 관리

**지금 당장 `http://localhost:3001`에서 모든 기능을 체험할 수 있습니다!** 🚀✨

## 🎊 **2024.12.22 - 현대적 UX + 완전한 가계부 완성!** 🎉

### ✅ **혁신적 업그레이드 완성 사항**

- **현대적 디자인**: 슬레이트 색상 팔레트 + 한국어 웹폰트
- **통합 인증 시스템**: 이메일 우선 + 분할 입력 방식
- **사용자 여정 단순화**: 로그인 후 바로 가계부/그룹 관리
- **거래 API 연동**: 수동 입력 → 서버 저장 → 실시간 공유
- **오프라인 지원**: 네트워크 오류시 로컬 저장 후 동기화 대기
- **완전한 CRUD**: 생성/조회/수정/삭제 모든 기능 서버 연동
- **가족 그룹 가계부**: 여러 명이 실시간으로 거래 공유

### 🚀 **혁신적 사용자 경험**

```
🎨 세련된 슬레이트 디자인으로 첫 인상부터 modern
📧 이메일 입력 → 자동으로 로그인/회원가입 분기
🚀 로그인 완료 → 바로 가계부 또는 그룹 관리 페이지
💰 "커피 5000원" 입력 → 즉시 서버 저장 → 가족들 실시간 확인
```

**🎯 MVP 가계부에서 2024년 최신 UX를 갖춘 완전한 상용 서비스로 업그레이드 완료!** ✨
